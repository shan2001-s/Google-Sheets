<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>Lisbon Blockchain Week</title><!-- MDB UI KIT -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.0/mdb.min.css" />
  <!-- Custom styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cdbootstrap/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cdbootstrap/css/cdb.min.css" />
  <style>
    .heart-icon.green {
      fill: red;
      cursor: pointer;
    }

    .heart-icon.black {
      fill: black;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <!--Main Navigation-->
  <header class="mb-10">

    <nav class="navbar bg-primary bg-body-tertiary" style="position: fixed; top: 0; right: 0; left: 0;">
      <div class="container-fluid">
      <a class="navbar-brand text-white" href="">Lisbon Blockchain Week</a>
        <form class="d-flex"   >
          <input class="form-control me-2 "    placeholder="Search" id="searchInput"
          onkeyup="filterTable()">
        </form>
      </div>
    </nav>
  </header>
  <!--Main Navigation-->

  <!--Main layout-->
  <main>

    <div class="container" style="margin-top: -30px;">
      <div class="d-flex justify-content-between ">
        <div class="">
          <h2>September 2023</h2>
        </div>
        <div class=" d-flex align-items-center">
          <select id="categorySelect" onchange="filterTableByCategory()" style="background-color: rgb(244, 244, 244) ; border-style: dotted ; border-color: rgb(36, 62, 255); margin-top: 10px;" class="form-select form-select-lg mb-3 w-auto me-5" aria-label="Large select example">
            <option selected>All</option>
            <option value="Favorites">Favorites </option>
            <option value="Conferences">Conferences</option>
            <option value="Events">Events</option>
            <option value="Drinks">Drinks</option>
        </select>

        
          <a class="  btn btn-primary btn-rounded d-flex align-items-center " type="submit">Summit Event</a>
        </div>

      </div>
      
     



      <div>
        <div class=" mt-3">
          <ul class="nav pt-1 ps-lg-5 pe-lg-5 pb-1  nav-tabs mb-3 d-flex justify-content-between " style="background-color: rgb(234, 234, 234);  " id="ex1" role="tablist">
            <li class="nav-item" role="presentation">
              <a class="nav-link   fs-6 text-center"  href="index.html" role="tab"
                >Mon <br>12</a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link  fs-6 text-center"  href="indexTue.html" role="tab"
                >Tue <br>13</a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link  fs-6 text-center"  href="indexWed.html" role="tab"
              >Wed <br>14</a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link  fs-6 text-center"  href="indexThur.html" role="tab"
              >Thur <br>15</a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link  fs-6 text-center"  href="indexFri.html" role="tab"
                >Fri <br>16</a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link active  fs-6 text-center"  href="#" role="tab"
                >Sat <br>17</a>
            </li>
            <li class="nav-item" role="presentation">
              <a class="nav-link  fs-6 text-center"  href="indexSun.html" role="tab"
              >Sun <br>18</a>
            </li>

          </ul>
          <div class="tab-content" id="ex1-content">
            <div class="tab-pane fade show active" id="ex1-tabs-1" role="tabpanel" aria-labelledby="ex1-tab-1">
              <table  class="table "   id="DataTable">

                <tbody id="table-body1"></tbody>
              </table>
            </div>
            <div class="tab-pane fade" id="ex1-tabs-2" role="tabpanel" aria-labelledby="ex1-tab-2">
             <table  class="table "   id="DataTable">

                <tbody id="table-body2"></tbody>
              </table>
            </div>
            <div class="tab-pane fade" id="ex1-tabs-3" role="tabpanel" aria-labelledby="ex1-tab-3">
              Tab 3 content
            </div>
            <div class="tab-pane fade" id="ex1-tabs-4" role="tabpanel" aria-labelledby="ex1-tab-4">
              Tab 4 content
            </div>
            <div class="tab-pane fade" id="ex1-tabs-5" role="tabpanel" aria-labelledby="ex1-tab-5">
              Tab 5 content
            </div>
            <div class="tab-pane fade" id="ex1-tabs-6" role="tabpanel" aria-labelledby="ex1-tab-6">
              Tab 6 content
            </div>
            <div class="tab-pane fade " id="ex1-tabs-7" role="tabpanel" aria-labelledby="ex1-tab-7">
              Tab 7 content
            </div>
          </div>
        </div>

      </div>



      <!-- Table -->

      <!-- Table -->
    </div>
  </main>
  <!--Main layout-->

  <!--Footer-->
  <footer></footer>
  <!--Footer-->
</body>

<!-- MDB ESSENTIAL -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.10.0/mdb.min.js"></script>
<!-- Google API -->
<script src="https://apis.google.com/js/api.js"></script>
<!-- easyData -->
<script type="text/javascript" src="js/easyData-google-sheets.js"></script>

<!-- easyData - Creating table -->
<script>
  {
    {
      // Your API KEY
      const API_KEY = "AIzaSyAKT4NnXuhCcpx16JS3de4wdpcTMDoRAgc";

      // for search

      function filterTable() {
  let input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("searchInput");
  filter = input.value.toUpperCase();
  table = document.getElementsByClassName("show")[0]; // Select the first element with the class "show"
  tr = table.getElementsByTagName("tr");

  for (i = 1; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td");
    let match = false;
    for (let j = 0; j < td.length; j++) {
      txtValue = td[j].textContent || td[j].innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        match = true;
        break;
      }
    }
    tr[i].style.display = match ? "" : "none";
  }
}

      let AllData;


    //  for filter option

    function filterTableByCategory() {
    var selectedCategory = document.getElementById('categorySelect').value;
    var rows = document.querySelectorAll('.show tbody tr');
    let existingData = JSON.parse(localStorage.getItem('clickedIndexesL')) || [];

    if (selectedCategory === 'All') {
        rows.forEach(function(row) {
            row.style.display = '';
        });
    } else if (selectedCategory === 'Favorites') {
        rows.forEach(function(row) {
          var itemText = row.children[2].textContent.trim(); 
            console.log(itemText);
            console.log(existingData);
            if (existingData.includes(itemText)) {
              console.log('if',itemText);
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    } else {
        rows.forEach(function(row) {
            var categories = row.children[3].textContent;
            if (categories.includes(selectedCategory)) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }
}


      // for Monday
      function displayResult1(response) {
        let tableHead = "";
        let tableBody = "";
        let FirstRowTime=response.result.values[0];
       AllData=response.result.values
        console.log(FirstRowTime[0]);

        response.result.values.forEach((row, index) => {
          if (index === 1 || index === 0) {
            tableHead += "<tr>";
            row.forEach((val) => (tableHead += "<th>" + val + "</th>"));
            tableHead += "</tr>";
          } else {
            tableBody += "<tr>";
            let existingData = JSON.parse(localStorage.getItem('clickedIndexesL')) || [];

            if (existingData.includes(row[0,1])) {

              tableBody += `<td>
                    <a style="cursor: pointer;" class="heart-btn" onclick="handleButtonClick(${index})" id="heartBtnContainer${index}">
                        <svg class="heart-icon green" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">
                            <path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/>
                        </svg>
                    </a>
                </td>`
            } else {
              tableBody += `<td>
                    <a style="cursor: pointer;" class="heart-btn" onclick="handleButtonClick(${index})" id="heartBtnContainer${index}">
                        <svg class="heart-icon" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">
                            <path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/>
                        </svg>
                    </a>
                </td>`
            }

            // Display data from column A , B and C
            tableBody += "<td>" + row[0] + "</td>";


            // Add the code for modals here
            const modalId = `T${row[1].replace(/\s+/g, '&nbsp;')}`;
            // Time for google calander
            function convertTimeToISO(time) {
              const [start, end] = time.split(' - ');
              let originalDate = `${FirstRowTime[0]}`;
              let formattedDate = originalDate.replace(/-/g, '');
              console.log(formattedDate); // Output: "20231018"
              console.log(originalDate); 

              const isoStartDate = `${formattedDate}T${start.replace(':', '')}00`;
              const isoEndDate = `${formattedDate}T${end.replace(':', '')}00`;

              return `${isoStartDate}/${isoEndDate}`;
            }

            const time = `${row[index,0]}`;
            const isoTime = convertTimeToISO(time);
            let dateForModel =response.result.values[0]

           
            tableBody += `
                <td>
                    <a type="button" data-bs-toggle="modal" data-bs-target="#${modalId}" style='color:black; font-size: 15px ;text-decoration: underline;'>${row[1]}</a>
                </td>
                <!-- Modal -->
                <div class="modal fade" id="${modalId}" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                              <h1 class="modal-title fs-5" >${row[0]} (${dateForModel[0]})</h1> 
                               
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                              <h5 >${row[1]}</h5>
                              <br>
                                <h5>Description</h5>
                               <p>${row[3]}</p>
                               <h5> Speaker </h5>
                               <p class="mb-2"> ${row[4]}<p> 
                                <div class='p-2 '>   <a  href="${row[6]}" target="_blank"> ${row[5]}<a></div>
                                  <div class='p-2 '>   <a  href="https://calendar.google.com/calendar/u/0/r/eventedit?text=${row[1]}&location=${row[5]}&dates=${isoTime}" target="_blank"> Add Event To Google Calendar<a></div>
                                  <div class='p-2'>   <a  href="${row[7]}" target="_blank">Event Url<a></div>

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
          
           const data1=`${row[2]}`
const categories1 = data1.split(' / ');



let categoryString = '';

categories1.forEach(category => {
    categoryString += `
        <span style='font-size: 13px;' class="ps-3 pe-3 rounded-pill bg-info text-white">${category}</span>
    `;
});

tableBody += `<td>${categoryString}</td>`;
            tableBody += "</tr>";
          }
        });

        document.getElementById("table-body1").innerHTML = tableBody;

        filterTable();
      }
      // for love btn
      function handleButtonClick(index) {
        let RowData = AllData[index]
       
        console.log(RowData[1]);

        // Retrieve existing data from local storage (if any)
        let existingData = JSON.parse(localStorage.getItem('clickedIndexesL')) || [];

        // Check if the index is already in the array
        const indexExists = existingData.indexOf(RowData[1]) !== -1;

        if (indexExists) {
          // Remove the index from the array
          existingData = existingData.filter(item => item !== RowData[1]);
        } else {
          // Add the index to the array
          existingData.push(RowData[1]);
        }

        // Save the updated array back to local storage
        localStorage.setItem('clickedIndexesL', JSON.stringify(existingData));

        // Update button style
        const button = document.getElementById(`heartBtnContainer${index}`);
        if (indexExists) {
          button.classList.remove('highlighted');
          button.querySelector('.heart-icon').classList.remove('green');
          button.querySelector('.heart-icon').classList.add('black');
        } else {
          button.classList.add('highlighted');
          button.querySelector('.heart-icon').classList.remove('black');
          button.querySelector('.heart-icon').classList.add('green');
        }

      }
        function handleButtonClick(index) {
        let RowData = AllData[index]
       
        console.log(RowData[1]);

        // Retrieve existing data from local storage (if any)
        let existingData = JSON.parse(localStorage.getItem('clickedIndexesL')) || [];

        // Check if the index is already in the array
        const indexExists = existingData.indexOf(RowData[1]) !== -1;

        if (indexExists) {
          // Remove the index from the array
          existingData = existingData.filter(item => item !== RowData[1]);
        } else {
          // Add the index to the array
          existingData.push(RowData[1]);
        }

        // Save the updated array back to local storage
        localStorage.setItem('clickedIndexesL', JSON.stringify(existingData));

        // Update button style
        const button = document.getElementById(`heartBtnContainer${index}`);
        if (indexExists) {
          button.classList.remove('highlighted');
          button.querySelector('.heart-icon').classList.remove('green');
          button.querySelector('.heart-icon').classList.add('black');
        } else {
          button.classList.add('highlighted');
          button.querySelector('.heart-icon').classList.remove('black');
          button.querySelector('.heart-icon').classList.add('green');
        }

      }
      function loadData() {
        // Spreadsheet ID
        const spreadsheetId = "1SX-0rNXZ-yp_4wtoHp_eFuDklyCXDqwi1ca0YtV9E9U";
        const sheet1Range = "Saturday!A:Z";
      

        getPublicValues({ spreadsheetId, range: sheet1Range }, displayResult1);
    

      }

      document.addEventListener("gapi-loaded", (e) => {
        loadData();

      });

      window.addEventListener("load", (e) => {
        initOAuthClient({ apiKey: API_KEY });
      });


    }
  }
</script>


<script src="https://cdn.jsdelivr.net/npm/cdbootstrap/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/cdbootstrap/js/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/cdbootstrap/js/cdb.min.js"></script>

</html>